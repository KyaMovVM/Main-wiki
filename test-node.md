# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è `src/test-node.js`

## –ß—Ç–æ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å—Å—è

–ú—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –¥–≤–∞ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞—à Node‚Äë—Å–∫—Ä–∏–ø—Ç **src/test-node.js** –≤ Docker‚Äë–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ CI/CD‚Äëpipeline Gitea. –í—Å—ë –Ω–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º –¥–ª—è Junior‚Äë—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

---

## 1Ô∏è‚É£ Dockerfile ‚Äì –æ–±—Ä–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```dockerfile Dockerfile
# –ë–∞–∑–æ–≤—ã–π –ª—ë–≥–∫–∏–π –æ–±—Ä–∞–∑ Node.js (‚âà30‚ÄØ–ú–ë)
FROM node:20-alpine AS builder

# –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π —Ñ–∞–π–ª (–º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ)
COPY src/test-node.js ./test-node.js

# –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
EXPOSE 3010

# –ö–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
CMD ["node", "test-node.js"]
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π —à–∞–≥  

| –®–∞–≥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `FROM node:20-alpine` | –ë–µ—Ä—ë–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ Node.js –Ω–∞ –±–∞–∑–µ Alpine Linux. |
| `WORKDIR /app` | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é ‚Äî –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∑–¥–µ—Å—å. |
| `COPY src/test-node.js ./test-node.js` | –ö–æ–ø–∏—Ä—É–µ–º –≤–∞—à —Å–∫—Ä–∏–ø—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. |
| `EXPOSE 3010` | –û–±—ä—è–≤–ª—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç‚ÄØ3010 (—ç—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–∞ –Ω–∞—Ä—É–∂—É). |
| `CMD ["node", "test-node.js"]` | –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å—Ä–∞–∑—É —Å—Ç–∞—Ä—Ç—É–µ—Ç –≤–∞—à Node‚Äë—Å–µ—Ä–≤–µ—Ä. |

### –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞, —Ç–µ–≥–∏—Ä—É–µ–º –∫–∞–∫ test-node
docker build -t test-node .

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Ä—Ç 3010 –Ω–∞—Ä—É–∂—É
docker run -d -p 3010:3010 --name test-node-container test-node
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:3010`.

---

## 2Ô∏è‚É£ Gitea Actions workflow ‚Äì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ **`.gitea/workflows`** (–µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç) –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª **`docker-deploy.yml`**:

```yaml .gitea/workflows/docker-deploy.yml
name: Build & Deploy test-node
on:
  push:
    branches: [ main ]          # –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É main
  pull_request:
    branches: [ main ]

jobs:
  build-and-run:
    runs-on: self-hosted        # –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π runner —Å Docker
    timeout-minutes: 15         # –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ 15‚Äë—é –º–∏–Ω—É—Ç–∞–º–∏

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Docker Buildx (optional, for multi‚Äëarch)
        uses: docker/setup-buildx-action@v2

      # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—É—à–∏—Ç—å –æ–±—Ä–∞–∑ –≤ —Ä–µ–µ—Å—Ç—Ä ‚Äì —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
      # - name: Log in to Docker registry
      #   uses: docker/login-action@v2
      #   with:
      #     registry: ghcr.io
      #     username: ${{ secrets.REGISTRY_USER }}
      #     password: ${{ secrets.REGISTRY_PASSWORD }}

      - name: Build Docker image
        run: |
          docker build -t test-node:${{ github.sha }} .

      - name: Run container (detached)
        run: |
          docker run -d --rm \
            -p 3010:3010 \
            --name test-node-${{ github.run_id }} \
            test-node:${{ github.sha }}

      # –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
      - name: Verify service is reachable
        run: |
          sleep 5   # –¥–∞—ë–º Node –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç
          curl -f http://localhost:3010 || exit 1

      # –û—Å—Ç–∞–Ω–æ–≤–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã (—á–∏—Å—Ç–∫–∞)
      - name: Stop container
        if: always()
        run: |
          docker rm -f test-node-${{ github.run_id }} || true
```

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

- **`runs-on: self-hosted`** ‚Äì workflow –±—É–¥–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –≤–∞—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–∞–Ω–Ω–µ—Ä–µ (—Ç–æ—Ç, –æ –∫–æ—Ç–æ—Ä–æ–º –≤—ã —É–ø–æ–º–∏–Ω–∞–ª–∏). –ù–∞ –Ω—ë–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker.
- **`timeout-minutes: 15`** ‚Äì –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤–µ—Å—å job –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –Ω–µ –ø–æ–∑–∂–µ 15‚ÄØ–º–∏–Ω—É—Ç, –∫–∞–∫ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –≤ –∑–∞–¥–∞—á–µ ¬´—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ 15 –º–∏–Ω—É—Ç¬ª.
- –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ, –¥–µ–ª–∞–µ—Ç—Å—è –∫–æ—Ä–æ—Ç–∫–∞—è health‚Äëcheck (`curl`) –∏ –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, —á—Ç–æ–±—ã runner –æ—Å—Ç–∞–≤–∞–ª—Å—è —á–∏—Å—Ç—ã–º.

---

## üìã –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å

1. **–î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã**  
   - `Dockerfile` –≤ –∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.  
   - `.gitea/workflows/docker-deploy.yml` (—Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç).

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Gitea‚Äë—Ä–∞–Ω–Ω–µ—Ä** –Ω–∞ –º–∞—à–∏–Ω–µ —Å Docker.

3. **–°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç –∏ –ø—É—à** –≤ –≤–µ—Ç–∫—É `main`. Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, —Å–æ–±–µ—Ä—ë—Ç –æ–±—Ä–∞–∑, –ø–æ–¥–Ω–∏–º–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ 15‚ÄØ–º–∏–Ω—É—Ç –∏ –ø–æ—Ç–æ–º –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –µ–≥–æ.

---

## –ß—Ç–æ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ Junior‚Äë—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É

- –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Docker‚Äë–æ–±—Ä–∞–∑ –¥–ª—è Node‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.  
- –ö–∞–∫ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞—Ä—É–∂—É.  
- –ö–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π CI/CD‚Äë—Å–∫—Ä–∏–ø—Ç –≤ Gitea, –∫–æ—Ç–æ—Ä—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.  
- –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (curl + –Ω–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞).  

–ï—Å–ª–∏ –≤—Å—ë —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ—Å–ª–µ –ø—É—à–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª–µ **Actions** —Å—Ç–∞—Ç—É—Å `success`, –∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `http://<runner‚Äëhost>:3010` —Ä–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏, —Å–∫–æ–ª—å–∫–æ –ø–æ–∑–≤–æ–ª–∏–ª —Ç–∞–π–º–∞—É—Ç.

–£–¥–∞—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã! üöÄ

# 2 ver–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è Junior Developer: Docker –∏ Gitea Actions –¥–ª—è test-node.js

## –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Node.js —Å–µ—Ä–≤–µ—Ä–æ–º (test-node.js) –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ —Å –ø–æ–º–æ—â—å—é Gitea Actions.  –û–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –ø–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤—ã Docker –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Å–±–æ—Ä–∫–∏/—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## 1. `Dockerfile`: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞ Docker

–§–∞–π–ª `Dockerfile` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è –Ω–∞—à–µ–≥–æ Node.js —Å–µ—Ä–≤–µ—Ä–∞. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É:

```dockerfile
# Use an official lightweight Node runtime
FROM node:20-alpine AS builder
```

*   **`FROM node:20-alpine AS builder`**:  –≠—Ç–æ —Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —Å—Ç—Ä–æ–∫–∞! –û–Ω–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π –æ–±—Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –¥–ª—è –Ω–∞—à–µ–≥–æ. `node:20-alpine` - —ç—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ Node.js –≤–µ—Ä—Å–∏–∏ 20, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Alpine Linux. Alpine - –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ Linux (–æ–∫–æ–ª–æ 30 –ú–ë), —á—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–∞—à —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ Docker –±–æ–ª–µ–µ –ª–µ–≥–∫–∏–º –∏ –±—ã—Å—Ç—Ä—ã–º.  `AS builder` –¥–∞–µ—Ç —ç—Ç–æ–º—É —ç—Ç–∞–ø—É –∏–º—è "builder", —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã—Ö —Å–±–æ—Ä–æ–∫ (multistage builds).

```dockerfile
# Set working directory inside the image
WORKDIR /app
```

*   **`WORKDIR /app`**: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ `/app`.  –≠—Ç–æ –∫–∞–∫ `cd /app` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

```dockerfile
# Copy only the source file we need (you can copy the whole project if you like)
COPY src/test-node.js ./test-node.js
```

*   **`COPY src/test-node.js ./test-node.js`**: –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª `src/test-node.js` –∏–∑ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å–æ—Ö—Ä–∞–Ω—è—è –µ–≥–æ –∫–∞–∫ `./test-node.js` (—Ç–æ –µ—Å—Ç—å –≤ `/app`).  –í–∞–∂–Ω–æ: –µ—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª, Docker –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç —ç—Ç–æ—Ç —Å–ª–æ–π –æ–±—Ä–∞–∑–∞, —á—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è.

```dockerfile
# Expose the port that the server listens on (3010)
EXPOSE 3010
```

*   **`EXPOSE 3010`**:  –°–æ–æ–±—â–∞–µ—Ç Docker, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç 3010. –≠—Ç–æ –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç –ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ; —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

```dockerfile
# The command that will be executed when the container starts
CMD ["node", "test-node.js"]
```

*   **`CMD ["node", "test-node.js"]`**:  –£–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, —ç—Ç–æ –∑–∞–ø—É—Å–∫ Node.js —Å–µ—Ä–≤–µ—Ä–∞ —Å —Ñ–∞–π–ª–æ–º `test-node.js`.

## 2. `.gitea/workflows/docker-deploy.yml`: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞

–§–∞–π–ª `docker-deploy.yml` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Gitea Actions workflow, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞ –∏ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞.

```yaml
name: Build & Deploy test‚Äënode
on:
push:
branches: [ main ]          # run on pushes to `main`
pull_request:
branches: [ main ]
jobs:
build-and-run:
runs-on: self-hosted        # uses a Gitea runner you have set up
timeout-minutes: 15         # <-- stops the job after 15‚ÄØminutes
steps:
- name: Checkout repository
uses: actions/checkout@v3
```

*   **`name: Build & Deploy test‚Äënode`**:  –ò–º—è workflow.
*   **`on:`**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–æ–≥–¥–∞ workflow –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è (–ø—Ä–∏ push –∏–ª–∏ pull request –≤ –≤–µ—Ç–∫—É `main`).
*   **`jobs:`**:  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞: `build-and-run`.
*   **`runs-on: self-hosted`**: –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ workflow –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –≤–∞—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º Gitea runner. –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —ç—Ç–æ—Ç runner –æ—Ç–¥–µ–ª—å–Ω–æ.
*   **`timeout-minutes: 15`**:  –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow –¥–æ 15 –º–∏–Ω—É—Ç. –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ 15-–º–∏–Ω—É—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ.
*   **`steps:`**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ –∑–∞–¥–∞—á–µ `build-and-run`.

```yaml
- name: Set up Docker Buildx (optional, for multi‚Äëarch)
uses: docker/setup-buildx-action@v2
- name: Log in to Docker registry (if you push)
# Uncomment and fill if you need to push the image somewhere
# uses: docker/login-action@v2
# with:
#   registry: ghcr.io
#   username: ${{ secrets.REGISTRY_USER }}
#   password: ${{ secrets.REGISTRY_PASSWORD }}
- name: Build Docker image
run: |
docker build -t test-node:${{ github.sha }} .
```

*   **`uses: actions/checkout@v3`**:  –í—ã–ø–æ–ª–Ω—è–µ—Ç checkout —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
*   **`docker build -t test-node:${{ github.sha }} .`**: –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑ –∏ —Ç–µ–≥–∏—Ä—É–µ—Ç –µ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SHA –∫–æ–º–º–∏—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –∫–∞–∫–æ–π –æ–±—Ä–∞–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫–æ–º—É –∫–æ–º–º–∏—Ç—É.

```yaml
- name: Run container (detached)
run: |
docker run -d --rm \
-p 3010:3010 \
--name test-node-${{ github.run_id }} \
test-node:${{ github.sha }}
# OPTIONAL ‚Äì simple health‚Äëcheck to ensure the server is up
- name: Verify service is reachable
run: |
sleep 5   # give Node a moment to start
curl -f http://localhost:3010 || exit 1
# OPTIONAL ‚Äì stop container after the job (cleanup)
- name: Stop container
if: always()
run: |
docker rm -f test-node-${{ github.run_id }} || true
```

*   **`docker run ...`**: –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ detached —Ä–µ–∂–∏–º–µ (`-d`), —É–¥–∞–ª—è–µ—Ç –µ–≥–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (`--rm`), –ø—É–±–ª–∏–∫—É–µ—Ç –ø–æ—Ä—Ç 3010 –∏ –¥–∞–µ—Ç –µ–º—É –∏–º—è, –≤–∫–ª—é—á–∞—é—â–µ–µ ID –∑–∞–ø—É—Å–∫–∞.
*   **`curl -f http://localhost:3010 || exit 1`**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø–æ—Ä—Ç—É 3010. –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, workflow –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π.
*   **`docker rm -f test-node-${{ github.run_id }} || true`**: –£–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è workflow (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞).

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è Juniora:

* **–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π Runner:**  –í–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Gitea runner –Ω–∞ –º–∞—à–∏–Ω–µ —Å Docker. –≠—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ Gitea.
* **–°–µ–∫—Ä–µ—Ç—ã:** –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–±—Ä–∞–∑ –≤ —Ä–µ–µ—Å—Ç—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitHub Container Registry), –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã `REGISTRY_USER` –∏ `REGISTRY_PASSWORD` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Gitea.
* **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:**  Workflow –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ 15 –º–∏–Ω—É—Ç. –ï—Å–ª–∏ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ, workflow –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω —É—Å–ø–µ–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.
* **–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫:** –í—ã –º–æ–∂–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥ `docker build -t test-node .` –∏ `docker run -d -p 3010:3010 --name test-node-container test-node`. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
* **–û—á–∏—Å—Ç–∫–∞:**  Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ runner'–µ.

```tool
TOOL_NAME: create_rule_block
BEGIN_ARG: name
Explain Dockerfile Steps